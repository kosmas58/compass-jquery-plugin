(function(n){var o=n.DOM,i=n.dom.Event,k=n.extend,m=n.each,j=n.util.Cookie,l,p=n.explode;n.ThemeManager.requireLangPack("advanced");n.create("tinymce.themes.AdvancedTheme",{sizes:[8,10,12,14,18,24,36],controls:{bold:["bold_desc","Bold"],italic:["italic_desc","Italic"],underline:["underline_desc","Underline"],strikethrough:["striketrough_desc","Strikethrough"],justifyleft:["justifyleft_desc","JustifyLeft"],justifycenter:["justifycenter_desc","JustifyCenter"],justifyright:["justifyright_desc","JustifyRight"],justifyfull:["justifyfull_desc","JustifyFull"],bullist:["bullist_desc","InsertUnorderedList"],numlist:["numlist_desc","InsertOrderedList"],outdent:["outdent_desc","Outdent"],indent:["indent_desc","Indent"],cut:["cut_desc","Cut"],copy:["copy_desc","Copy"],paste:["paste_desc","Paste"],undo:["undo_desc","Undo"],redo:["redo_desc","Redo"],link:["link_desc","mceLink"],unlink:["unlink_desc","unlink"],image:["image_desc","mceImage"],cleanup:["cleanup_desc","mceCleanup"],help:["help_desc","mceHelp"],code:["code_desc","mceCodeEditor"],hr:["hr_desc","InsertHorizontalRule"],removeformat:["removeformat_desc","RemoveFormat"],sub:["sub_desc","subscript"],sup:["sup_desc","superscript"],forecolor:["forecolor_desc","ForeColor"],forecolorpicker:["forecolor_desc","mceForeColor"],backcolor:["backcolor_desc","HiliteColor"],backcolorpicker:["backcolor_desc","mceBackColor"],charmap:["charmap_desc","mceCharMap"],visualaid:["visualaid_desc","mceToggleVisualAid"],anchor:["anchor_desc","mceInsertAnchor"],newdocument:["newdocument_desc","mceNewDocument"],blockquote:["blockquote_desc","mceBlockQuote"]},stateControls:["bold","italic","underline","strikethrough","bullist","numlist","justifyleft","justifycenter","justifyright","justifyfull","sub","sup","blockquote"],init:function(d,c){var b=this,a,e,f;b.editor=d;b.url=c;b.onResolveName=new n.util.Dispatcher(this);d.forcedHighContrastMode=d.settings.detect_highcontrast&&b._isHighContrast();d.settings.skin=d.forcedHighContrastMode?"highcontrast":d.settings.skin;b.settings=a=k({theme_advanced_path:true,theme_advanced_toolbar_location:"bottom",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,styleselect,formatselect",theme_advanced_buttons2:"bullist,numlist,|,outdent,indent,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code",theme_advanced_buttons3:"hr,removeformat,visualaid,|,sub,sup,|,charmap",theme_advanced_blockformats:"p,address,pre,h1,h2,h3,h4,h5,h6",theme_advanced_toolbar_align:"center",theme_advanced_fonts:"Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats",theme_advanced_more_colors:1,theme_advanced_row_height:23,theme_advanced_resize_horizontal:1,theme_advanced_resizing_use_cookie:1,theme_advanced_font_sizes:"1,2,3,4,5,6,7",theme_advanced_font_selector:"span",theme_advanced_show_current_color:0,readonly:d.settings.readonly},d.settings);if(!a.font_size_style_values){a.font_size_style_values="8pt,10pt,12pt,14pt,18pt,24pt,36pt"}if(n.is(a.theme_advanced_font_sizes,"string")){a.font_size_style_values=n.explode(a.font_size_style_values);a.font_size_classes=n.explode(a.font_size_classes||"");f={};d.settings.theme_advanced_font_sizes=a.theme_advanced_font_sizes;m(d.getParam("theme_advanced_font_sizes","","hash"),function(g,h){var r;if(h==g&&g>=1&&g<=7){h=g+" ("+b.sizes[g-1]+"pt)";r=a.font_size_classes[g-1];g=a.font_size_style_values[g-1]||(b.sizes[g-1]+"pt")}if(/^\s*\./.test(g)){r=g.replace(/\./g,"")}f[h]=r?{"class":r}:{fontSize:g}});a.theme_advanced_font_sizes=f}if((e=a.theme_advanced_path_location)&&e!="none"){a.theme_advanced_statusbar_location=a.theme_advanced_path_location}if(a.theme_advanced_statusbar_location=="none"){a.theme_advanced_statusbar_location=0}if(d.settings.content_css!==false){d.contentCSS.push(d.baseURI.toAbsolute(c+"/skins/"+d.settings.skin+"/content.css"))}d.onInit.add(function(){if(!d.settings.readonly){d.onNodeChange.add(b._nodeChanged,b);d.onKeyUp.add(b._updateUndoStatus,b);d.onMouseUp.add(b._updateUndoStatus,b);d.dom.bind(d.dom.getRoot(),"dragend",function(){b._updateUndoStatus(d)})}});d.onSetProgressState.add(function(v,x,u){var h,g=v.id,w;if(x){b.progressTimer=setTimeout(function(){h=v.getContainer();h=h.insertBefore(o.create("DIV",{style:"position:relative"}),h.firstChild);w=o.get(v.id+"_tbl");o.add(h,"div",{id:g+"_blocker","class":"mceBlocker",style:{width:w.clientWidth+2,height:w.clientHeight+2}});o.add(h,"div",{id:g+"_progress","class":"mceProgress",style:{left:w.clientWidth/2,top:w.clientHeight/2}})},u||0)}else{o.remove(g+"_blocker");o.remove(g+"_progress");clearTimeout(b.progressTimer)}});o.loadCSS(a.editor_css?d.documentBaseURI.toAbsolute(a.editor_css):c+"/skins/"+d.settings.skin+"/ui.css");if(a.skin_variant){o.loadCSS(c+"/skins/"+d.settings.skin+"/ui_"+a.skin_variant+".css")}},_isHighContrast:function(){var b,a=o.add(o.getRoot(),"div",{style:"background-color: rgb(171,239,86);"});b=(o.getStyle(a,"background-color",true)+"").toLowerCase().replace(/ /g,"");o.remove(a);return b!="rgb(171,239,86)"&&b!="#abef56"},createControl:function(a,d){var c,b;if(b=d.createControl(a)){return b}switch(a){case"styleselect":return this._createStyleSelect();case"formatselect":return this._createBlockFormats();case"fontselect":return this._createFontSelect();case"fontsizeselect":return this._createFontSizeSelect();case"forecolor":return this._createForeColorMenu();case"backcolor":return this._createBackColorMenu()}if((c=this.controls[a])){return d.createButton(a,{title:"advanced."+c[0],cmd:c[1],ui:c[2],value:c[3]})}},execCommand:function(b,c,a){var d=this["_"+b];if(d){d.call(this,c,a);return true}return false},_importClasses:function(a){var c=this.editor,b=c.controlManager.get("styleselect");if(b.getLength()==0){m(c.dom.getClasses(),function(f,e){var d="style_"+e;c.formatter.register(d,{inline:"span",attributes:{"class":f["class"]},selector:"*"});b.add(f["class"],d)})}},_createStyleSelect:function(a){var c=this,e=c.editor,d=e.controlManager,b;b=d.createListBox("styleselect",{title:"advanced.style_select",onselect:function(g){var f,h=[];m(b.items,function(r){h.push(r.value)});e.focus();e.undoManager.add();f=e.formatter.matchAll(h);if(!g||f[0]==g){if(f[0]){e.formatter.remove(f[0])}}else{e.formatter.apply(g)}e.undoManager.add();e.nodeChanged();return false}});e.onInit.add(function(){var f=0,g=e.getParam("style_formats");if(g){m(g,function(t){var s,h=0;m(t,function(){h++});if(h>1){s=t.name=t.name||"style_"+(f++);e.formatter.register(s,t);b.add(t.title,s)}else{b.add(t.title)}})}else{m(e.getParam("theme_advanced_styles","","hash"),function(h,s){var t;if(h){t="style_"+(f++);e.formatter.register(t,{inline:"span",classes:h,selector:"*"});b.add(c.editor.translate(s),t)}})}});if(b.getLength()==0){b.onPostRender.add(function(g,f){if(!b.NativeListBox){i.add(f.id+"_text","focus",c._importClasses,c);i.add(f.id+"_text","mousedown",c._importClasses,c);i.add(f.id+"_open","focus",c._importClasses,c);i.add(f.id+"_open","mousedown",c._importClasses,c)}else{i.add(f.id,"focus",c._importClasses,c)}})}return b},_createFontSelect:function(){var a,b=this,c=b.editor;a=c.controlManager.createListBox("fontselect",{title:"advanced.fontdefault",onselect:function(e){var d=a.items[a.selectedIndex];if(!e&&d){c.execCommand("FontName",false,d.value);return}c.execCommand("FontName",false,e);a.select(function(f){return e==f});if(d&&d.value==e){a.select(null)}return false}});if(a){m(c.getParam("theme_advanced_fonts",b.settings.theme_advanced_fonts,"hash"),function(d,e){a.add(c.translate(e),d,{style:d.indexOf("dings")==-1?"font-family:"+d:""})})}return a},_createFontSizeSelect:function(){var a=this,c=a.editor,e,b=0,d=[];e=c.controlManager.createListBox("fontsizeselect",{title:"advanced.font_size",onselect:function(f){var g=e.items[e.selectedIndex];if(!f&&g){g=g.value;if(g["class"]){c.formatter.toggle("fontsize_class",{value:g["class"]});c.undoManager.add();c.nodeChanged()}else{c.execCommand("FontSize",false,g.fontSize)}return}if(f["class"]){c.focus();c.undoManager.add();c.formatter.toggle("fontsize_class",{value:f["class"]});c.undoManager.add();c.nodeChanged()}else{c.execCommand("FontSize",false,f.fontSize)}e.select(function(h){return f==h});if(g&&(g.value.fontSize==f.fontSize||g.value["class"]==f["class"])){e.select(null)}return false}});if(e){m(a.settings.theme_advanced_font_sizes,function(h,f){var g=h.fontSize;if(g>=1&&g<=7){g=a.sizes[parseInt(g)-1]+"pt"}e.add(f,h,{style:"font-size:"+g,"class":"mceFontSize"+(b++)+(" "+(h["class"]||""))})})}return e},_createBlockFormats:function(){var a,c={p:"advanced.paragraph",address:"advanced.address",pre:"advanced.pre",h1:"advanced.h1",h2:"advanced.h2",h3:"advanced.h3",h4:"advanced.h4",h5:"advanced.h5",h6:"advanced.h6",div:"advanced.div",blockquote:"advanced.blockquote",code:"advanced.code",dt:"advanced.dt",dd:"advanced.dd",samp:"advanced.samp"},b=this;a=b.editor.controlManager.createListBox("formatselect",{title:"advanced.block",onselect:function(d){b.editor.execCommand("FormatBlock",false,d);return false}});if(a){m(b.editor.getParam("theme_advanced_blockformats",b.settings.theme_advanced_blockformats,"hash"),function(d,e){a.add(b.editor.translate(e!=d?e:c[d]),d,{"class":"mce_formatPreview mce_"+d})})}return a},_createForeColorMenu:function(){var a,d=this,c=d.settings,b={},e;if(c.theme_advanced_more_colors){b.more_colors_func=function(){d._mceColorPicker(0,{color:a.value,func:function(f){a.setColor(f)}})}}if(e=c.theme_advanced_text_colors){b.colors=e}if(c.theme_advanced_default_foreground_color){b.default_color=c.theme_advanced_default_foreground_color}b.title="advanced.forecolor_desc";b.cmd="ForeColor";b.scope=this;a=d.editor.controlManager.createColorSplitButton("forecolor",b);return a},_createBackColorMenu:function(){var a,d=this,c=d.settings,b={},e;if(c.theme_advanced_more_colors){b.more_colors_func=function(){d._mceColorPicker(0,{color:a.value,func:function(f){a.setColor(f)}})}}if(e=c.theme_advanced_background_colors){b.colors=e}if(c.theme_advanced_default_background_color){b.default_color=c.theme_advanced_default_background_color}b.title="advanced.backcolor_desc";b.cmd="HiliteColor";b.scope=this;a=d.editor.controlManager.createColorSplitButton("backcolor",b);return a},renderUI:function(e){var c,d,b,s=this,a=s.editor,h=s.settings,t,f,g;if(a.settings){a.settings.aria_label=h.aria_label+a.getLang("advanced.help_shortcut")}c=f=o.create("span",{role:"application","aria-labelledby":a.id+"_voice",id:a.id+"_parent","class":"mceEditor "+a.settings.skin+"Skin"+(h.skin_variant?" "+a.settings.skin+"Skin"+s._ufirst(h.skin_variant):"")});o.add(c,"span",{"class":"mceVoiceLabel",style:"display:none;",id:a.id+"_voice"},h.aria_label);if(!o.boxModel){c=o.add(c,"div",{"class":"mceOldBoxModel"})}c=t=o.add(c,"table",{role:"presentation",id:a.id+"_tbl","class":"mceLayout",cellSpacing:0,cellPadding:0});c=b=o.add(c,"tbody");switch((h.theme_advanced_layout_manager||"").toLowerCase()){case"rowlayout":d=s._rowLayout(h,b,e);break;case"customlayout":d=a.execCallback("theme_advanced_custom_layout",h,b,e,f);break;default:d=s._simpleLayout(h,b,e,f)}c=e.targetNode;g=t.rows;o.addClass(g[0],"mceFirst");o.addClass(g[g.length-1],"mceLast");m(o.select("tr",b),function(q){o.addClass(q.firstChild,"mceFirst");o.addClass(q.childNodes[q.childNodes.length-1],"mceLast")});if(o.get(h.theme_advanced_toolbar_container)){o.get(h.theme_advanced_toolbar_container).appendChild(f)}else{o.insertAfter(f,c)}i.add(a.id+"_path_row","click",function(q){q=q.target;if(q.nodeName=="A"){s._sel(q.className.replace(/^.*mcePath_([0-9]+).*$/,"$1"));return i.cancel(q)}});if(!a.getParam("accessibility_focus")){i.add(o.add(f,"a",{href:"#"},"<!-- IE -->"),"focus",function(){tinyMCE.get(a.id).focus()})}if(h.theme_advanced_toolbar_location=="external"){e.deltaHeight=0}s.deltaHeight=e.deltaHeight;e.targetNode=null;a.onKeyDown.add(function(r,v){var q=121,u=122;if(v.altKey){if(v.keyCode===q){s.toolbarGroup.focus();return i.cancel(v)}else{if(v.keyCode===u){o.get(r.id+"_path_row").focus();return i.cancel(v)}}}});a.addShortcut("alt+0","","mceShortcuts",s);return{iframeContainer:d,editorContainer:a.id+"_parent",sizeContainer:t,deltaHeight:e.deltaHeight}},getInfo:function(){return{longname:"Advanced theme",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",version:n.majorVersion+"."+n.minorVersion}},resizeBy:function(c,b){var a=o.get(this.editor.id+"_ifr");this.resizeTo(a.clientWidth+c,a.clientHeight+b)},resizeTo:function(e,a,c){var d=this.editor,b=this.settings,g=o.get(d.id+"_tbl"),f=o.get(d.id+"_ifr");e=Math.max(b.theme_advanced_resizing_min_width||100,e);a=Math.max(b.theme_advanced_resizing_min_height||100,a);e=Math.min(b.theme_advanced_resizing_max_width||65535,e);a=Math.min(b.theme_advanced_resizing_max_height||65535,a);o.setStyle(g,"height","");o.setStyle(f,"height",a);if(b.theme_advanced_resize_horizontal){o.setStyle(g,"width","");o.setStyle(f,"width",e);if(e<g.clientWidth){e=g.clientWidth;o.setStyle(f,"width",g.clientWidth)}}if(c&&b.theme_advanced_resizing_use_cookie){j.setHash("TinyMCE_"+d.id+"_size",{cw:e,ch:a})}},destroy:function(){var a=this.editor.id;i.clear(a+"_resize");i.clear(a+"_path_row");i.clear(a+"_external_close")},_simpleLayout:function(h,a,e,g){var s=this,A=s.editor,z=h.theme_advanced_toolbar_location,c=h.theme_advanced_statusbar_location,d,f,b,t;if(h.readonly){d=o.add(a,"tr");d=f=o.add(d,"td",{"class":"mceIframeContainer"});return f}if(z=="top"){s._addToolbars(a,e)}if(z=="external"){d=t=o.create("div",{style:"position:relative"});d=o.add(d,"div",{id:A.id+"_external","class":"mceExternalToolbar"});o.add(d,"a",{id:A.id+"_external_close",href:"javascript:;","class":"mceExternalClose"});d=o.add(d,"table",{id:A.id+"_tblext",cellSpacing:0,cellPadding:0});b=o.add(d,"tbody");if(g.firstChild.className=="mceOldBoxModel"){g.firstChild.appendChild(t)}else{g.insertBefore(t,g.firstChild)}s._addToolbars(b,e);A.onMouseUp.add(function(){var q=o.get(A.id+"_external");o.show(q);o.hide(l);var r=i.add(A.id+"_external_close","click",function(){o.hide(A.id+"_external");i.remove(A.id+"_external_close","click",r)});o.show(q);o.setStyle(q,"top",0-o.getRect(A.id+"_tblext").h-1);o.hide(q);o.show(q);q.style.filter="";l=A.id+"_external";q=null})}if(c=="top"){s._addStatusBar(a,e)}if(!h.theme_advanced_toolbar_container){d=o.add(a,"tr");d=f=o.add(d,"td",{"class":"mceIframeContainer"})}if(z=="bottom"){s._addToolbars(a,e)}if(c=="bottom"){s._addStatusBar(a,e)}return f},_rowLayout:function(t,d,f){var y=this,c=y.editor,z,s,h=c.controlManager,e,g,a,b;z=t.theme_advanced_containers_default_class||"";s=t.theme_advanced_containers_default_align||"center";m(p(t.theme_advanced_containers||""),function(q,r){var u=t["theme_advanced_container_"+q]||"";switch(q.toLowerCase()){case"mceeditor":e=o.add(d,"tr");e=g=o.add(e,"td",{"class":"mceIframeContainer"});break;case"mceelementpath":y._addStatusBar(d,f);break;default:b=(t["theme_advanced_container_"+q+"_align"]||s).toLowerCase();b="mce"+y._ufirst(b);e=o.add(o.add(d,"tr"),"td",{"class":"mceToolbar "+(t["theme_advanced_container_"+q+"_class"]||z)+" "+b||s});a=h.createToolbar("toolbar"+r);y._addControls(u,a);o.setHTML(e,a.renderHTML());f.deltaHeight-=t.theme_advanced_row_height}});return g},_addControls:function(d,e){var c=this,b=c.settings,a,f=c.editor.controlManager;if(b.theme_advanced_disable&&!c._disabled){a={};m(p(b.theme_advanced_disable),function(g){a[g]=1});c._disabled=a}else{a=c._disabled}m(p(d),function(g){var h;if(a&&a[g]){return}if(g=="tablecontrols"){m(["table","|","row_props","cell_props","|","row_before","row_after","delete_row","|","col_before","col_after","delete_col","|","split_cells","merge_cells"],function(r){r=c.createControl(r,f);if(r){e.add(r)}});return}h=c.createControl(g,f);if(h){e.add(h)}})},_addToolbars:function(C,h){var e=this,d,f,a=e.editor,c=e.settings,t,s=a.controlManager,E,g,b=[],v,D;D=s.createToolbarGroup("toolbargroup",{name:a.getLang("advanced.toolbar"),tab_focus_toolbar:a.getParam("theme_advanced_tab_focus_toolbar")});e.toolbarGroup=D;v=c.theme_advanced_toolbar_align.toLowerCase();v="mce"+e._ufirst(v);g=o.add(o.add(C,"tr",{role:"presentation"}),"td",{"class":"mceToolbar "+v,role:"presentation"});for(d=1;(t=c["theme_advanced_buttons"+d]);d++){f=s.createToolbar("toolbar"+d,{"class":"mceToolbarRow"+d});if(c["theme_advanced_buttons"+d+"_add"]){t+=","+c["theme_advanced_buttons"+d+"_add"]}if(c["theme_advanced_buttons"+d+"_add_before"]){t=c["theme_advanced_buttons"+d+"_add_before"]+","+t}e._addControls(t,f);D.add(f);h.deltaHeight-=c.theme_advanced_row_height}b.push(D.renderHTML());b.push(o.createHTML("a",{href:"#",accesskey:"z",title:a.getLang("advanced.toolbar_focus"),onfocus:"tinyMCE.getInstanceById('"+a.id+"').focus();"},"<!-- IE -->"));o.setHTML(g,b.join(""))},_addStatusBar:function(c,f){var e,r=this,b=r.editor,h=r.settings,g,a,s,d;e=o.add(c,"tr");e=d=o.add(e,"td",{"class":"mceStatusbar"});e=o.add(e,"div",{id:b.id+"_path_row",role:"group","aria-labelledby":b.id+"_path_voice"});if(h.theme_advanced_path){o.add(e,"span",{id:b.id+"_path_voice"},b.translate("advanced.path"));o.add(e,"span",{},": ")}else{o.add(e,"span",{},"&#160;")}if(h.theme_advanced_resizing){o.add(d,"a",{id:b.id+"_resize",href:"javascript:;",onclick:"return false;","class":"mceResize"});if(h.theme_advanced_resizing_use_cookie){b.onPostRender.add(function(){var t=j.getHash("TinyMCE_"+b.id+"_size"),q=o.get(b.id+"_tbl");if(!t){return}r.resizeTo(t.cw,t.ch)})}b.onPostRender.add(function(){i.add(b.id+"_resize","click",function(q){q.preventDefault()});i.add(b.id+"_resize","mousedown",function(q){var N,u,P,G,v,J,H,M,I,O,L;function K(t){t.preventDefault();I=H+(t.screenX-v);O=M+(t.screenY-J);r.resizeTo(I,O)}function w(t){i.remove(o.doc,"mousemove",N);i.remove(b.getDoc(),"mousemove",u);i.remove(o.doc,"mouseup",P);i.remove(b.getDoc(),"mouseup",G);I=H+(t.screenX-v);O=M+(t.screenY-J);r.resizeTo(I,O,true)}q.preventDefault();v=q.screenX;J=q.screenY;L=o.get(r.editor.id+"_ifr");H=I=L.clientWidth;M=O=L.clientHeight;N=i.add(o.doc,"mousemove",K);u=i.add(b.getDoc(),"mousemove",K);P=i.add(o.doc,"mouseup",w);G=i.add(b.getDoc(),"mouseup",w)})})}f.deltaHeight-=21;e=c=null},_updateUndoStatus:function(a){var b=a.controlManager;b.setDisabled("undo",!a.undoManager.hasUndo()&&!a.typing);b.setDisabled("redo",!a.undoManager.hasRedo())},_nodeChanged:function(L,v,s,I,h){var b=this,t,f=0,c,e,a=b.settings,d,N,g,H,M,O,P;n.each(b.stateControls,function(q){v.setActive(q,L.queryCommandState(b.controls[q][1]))});function K(u){var r,w=h.parents,q=u;if(typeof(u)=="string"){q=function(x){return x.nodeName==u}}for(r=0;r<w.length;r++){if(q(w[r])){return w[r]}}}v.setActive("visualaid",L.hasVisual);b._updateUndoStatus(L);v.setDisabled("outdent",!L.queryCommandState("Outdent"));t=K("A");if(e=v.get("link")){if(!t||!t.name){e.setDisabled(!t&&I);e.setActive(!!t)}}if(e=v.get("unlink")){e.setDisabled(!t&&I);e.setActive(!!t&&!t.name)}if(e=v.get("anchor")){e.setActive(!I&&!!t&&t.name)}t=K("IMG");if(e=v.get("image")){e.setActive(!I&&!!t&&s.className.indexOf("mceItem")==-1)}if(e=v.get("styleselect")){b._importClasses();O=[];m(e.items,function(q){O.push(q.value)});P=L.formatter.matchAll(O);e.select(P[0])}if(e=v.get("formatselect")){t=K(o.isBlock);if(t){e.select(t.nodeName.toLowerCase())}}K(function(q){if(q.nodeName==="SPAN"){if(!d&&q.className){d=q.className}}if(L.dom.is(q,a.theme_advanced_font_selector)){if(!N&&q.style.fontSize){N=q.style.fontSize}if(!g&&q.style.fontFamily){g=q.style.fontFamily.replace(/[\"\']+/g,"").replace(/^([^,]+).*/,"$1").toLowerCase()}if(!H&&q.style.color){H=q.style.color}if(!M&&q.style.backgroundColor){M=q.style.backgroundColor}}return false});if(e=v.get("fontselect")){e.select(function(q){return q.replace(/^([^,]+).*/,"$1").toLowerCase()==g})}if(e=v.get("fontsizeselect")){if(a.theme_advanced_runtime_fontsize&&!N&&!d){N=L.dom.getStyle(s,"fontSize",true)}e.select(function(q){if(q.fontSize&&q.fontSize===N){return true}if(q["class"]&&q["class"]===d){return true}})}if(a.theme_advanced_show_current_color){function J(q,r){if(e=v.get(q)){if(!r){r=e.settings.default_color}if(r!==e.value){e.displayColor(r)}}}J("forecolor",H);J("backcolor",M)}if(a.theme_advanced_show_current_color){function J(q,r){if(e=v.get(q)){if(!r){r=e.settings.default_color}if(r!==e.value){e.displayColor(r)}}}J("forecolor",H);J("backcolor",M)}if(a.theme_advanced_path&&a.theme_advanced_statusbar_location){t=o.get(L.id+"_path")||o.add(L.id+"_path_row","span",{id:L.id+"_path"});if(b.statusKeyboardNavigation){b.statusKeyboardNavigation.destroy();b.statusKeyboardNavigation=null}o.setHTML(t,"");K(function(u){var x=u.nodeName.toLowerCase(),w,q,r="";if(u.getAttribute("data-mce-bogus")){return}if(u.nodeType!=1||u.nodeName==="BR"||(o.hasClass(u,"mceItemHidden")||o.hasClass(u,"mceItemRemoved"))){return}if(n.isIE&&u.scopeName!=="HTML"){x=u.scopeName+":"+x}x=x.replace(/mce\:/g,"");switch(x){case"b":x="strong";break;case"i":x="em";break;case"img":if(c=o.getAttrib(u,"src")){r+="src: "+c+" "}break;case"a":if(c=o.getAttrib(u,"name")){r+="name: "+c+" ";x+="#"+c}if(c=o.getAttrib(u,"href")){r+="href: "+c+" "}break;case"font":if(c=o.getAttrib(u,"face")){r+="font: "+c+" "}if(c=o.getAttrib(u,"size")){r+="size: "+c+" "}if(c=o.getAttrib(u,"color")){r+="color: "+c+" "}break;case"span":if(c=o.getAttrib(u,"style")){r+="style: "+c+" "}break}if(c=o.getAttrib(u,"id")){r+="id: "+c+" "}if(c=u.className){c=c.replace(/\b\s*(webkit|mce|Apple-)\w+\s*\b/g,"");if(c){r+="class: "+c+" ";if(o.isBlock(u)||x=="img"||x=="span"){x+="."+c}}}x=x.replace(/(html:)/g,"");x={name:x,node:u,title:r};b.onResolveName.dispatch(b,x);r=x.title;x=x.name;q=o.create("a",{href:"javascript:;",role:"button",onmousedown:"return false;",title:r,"class":"mcePath_"+(f++)},x);if(t.hasChildNodes()){t.insertBefore(o.create("span",{"aria-hidden":"true"},"\u00a0\u00bb "),t.firstChild);t.insertBefore(q,t.firstChild)}else{t.appendChild(q)}},L.getBody());if(o.select("a",t).length>0){b.statusKeyboardNavigation=new n.ui.KeyboardNavigation({root:L.id+"_path_row",items:o.select("a",t),excludeFromTabOrder:true,onCancel:function(){L.focus()}},o)}}},_sel:function(a){this.editor.execCommand("mceSelectNodeDepth",false,a)},_mceInsertAnchor:function(a,b){var c=this.editor;c.windowManager.open({url:this.url+"/anchor.htm",width:320+parseInt(c.getLang("advanced.anchor_delta_width",0)),height:90+parseInt(c.getLang("advanced.anchor_delta_height",0)),inline:true},{theme_url:this.url})},_mceCharMap:function(){var a=this.editor;a.windowManager.open({url:this.url+"/charmap.htm",width:550+parseInt(a.getLang("advanced.charmap_delta_width",0)),height:250+parseInt(a.getLang("advanced.charmap_delta_height",0)),inline:true},{theme_url:this.url})},_mceHelp:function(){var a=this.editor;a.windowManager.open({url:this.url+"/about.htm",width:480,height:380,inline:true},{theme_url:this.url})},_mceShortcuts:function(){var a=this.editor;a.windowManager.open({url:this.url+"/shortcuts.htm",width:480,height:380,inline:true},{theme_url:this.url})},_mceColorPicker:function(a,b){var c=this.editor;b=b||{};c.windowManager.open({url:this.url+"/color_picker.htm",width:375+parseInt(c.getLang("advanced.colorpicker_delta_width",0)),height:250+parseInt(c.getLang("advanced.colorpicker_delta_height",0)),close_previous:false,inline:true},{input_color:b.color,func:b.func,theme_url:this.url})},_mceCodeEditor:function(b,a){var c=this.editor;c.windowManager.open({url:this.url+"/source_editor.htm",width:parseInt(c.getParam("theme_advanced_source_editor_width",720)),height:parseInt(c.getParam("theme_advanced_source_editor_height",580)),inline:true,resizable:true,maximizable:true},{theme_url:this.url})},_mceImage:function(b,a){var c=this.editor;if(c.dom.getAttrib(c.selection.getNode(),"class").indexOf("mceItem")!=-1){return}c.windowManager.open({url:this.url+"/image.htm",width:355+parseInt(c.getLang("advanced.image_delta_width",0)),height:275+parseInt(c.getLang("advanced.image_delta_height",0)),inline:true},{theme_url:this.url})},_mceLink:function(b,a){var c=this.editor;c.windowManager.open({url:this.url+"/link.htm",width:310+parseInt(c.getLang("advanced.link_delta_width",0)),height:200+parseInt(c.getLang("advanced.link_delta_height",0)),inline:true},{theme_url:this.url})},_mceNewDocument:function(){var a=this.editor;a.windowManager.confirm("advanced.newdocument",function(b){if(b){a.execCommand("mceSetContent",false,"")}})},_mceForeColor:function(){var a=this;this._mceColorPicker(0,{color:a.fgColor,func:function(b){a.fgColor=b;a.editor.execCommand("ForeColor",false,b)}})},_mceBackColor:function(){var a=this;this._mceColorPicker(0,{color:a.bgColor,func:function(b){a.bgColor=b;a.editor.execCommand("HiliteColor",false,b)}})},_ufirst:function(a){return a.substring(0,1).toUpperCase()+a.substring(1)}});n.ThemeManager.add("advanced",n.themes.AdvancedTheme)}(tinymce));