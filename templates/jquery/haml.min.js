(function(e){function l(a,b){if(a===undefined)return b==="undefined";if(a===null)return b==="null";return a.constructor.toString().match(RegExp(b,"i"))!==null}function q(a,b){if(a&&a[b]){var g=a[b];delete a[b];return g}}function u(a){if(typeof a!=="string"||a.length<2)return false;a=a.charAt(0);if(!(a==="."||a==="#"||a==="%"))return false;return true}function r(a,b){function g(h,c){if(!(c===undefined||c===null))if(c.nodeType||c.jquery)h.append(c);else if(l(c,"String")&&c.length>0){if(c[0]==="\\")c=
c.substr(1);h.append(document.createTextNode(c))}else if(l(c,"Number"))h.append(document.createTextNode(c));else l(c,"Array")&&c.length>0&&r(h,c)}var i,k,d,f,m,n,j;d=Array.prototype.slice.call(b,0);if(d.length&&d.length>0){if(u(d[0])){f=d.shift();m=f.match(/\.[^\.#]+/g);n=f.match(/#[^\.#]+/g);f=(f=f.match(/^%([^\.#]+)/g))?f[0].substr(1):"div";j=e(document.createElement(f));if(d.length>0&&l(d[0],"Object")&&!d[0].nodeType&&!d[0].jquery){f=d.shift();i=q(f,"css");k=q(f,"$");j.attr(f)}n&&e.each(n,function(){var h,
c;h=this.substr(1);(c=j.attr("id"))?j.attr("id",c+" "+h):j.attr("id",h)});m&&e.each(m,function(){j.addClass(this.substr(1))});i&&j.css(i);a.append(j);a=j;k&&e.each(k,function(h){o.push({node:a,method:h,params:this})})}e.each(d,function(){g(a,this)})}else g(a,d)}function s(){e.each(o,function(){if(this.method==="$")this.params.apply(this.node,[]);else{if(!l(this.params,"Array"))this.params=[this.params];this.node[this.method].apply(this.node,this.params)}});o=[]}function t(a){var b;b=e(document.createElement("div"));
r(b,a);this.append(b.contents());this.closest("body").length>0&&s();return b.contents()}var o=[],p={};e.fn.insertHaml=function(){return t.call(this,Array.prototype.slice.call(arguments,0))};e.fn.haml=function(){t.call(this,Array.prototype.slice.call(arguments,0));return this};e.haml={placeholder:function(a){function b(){var i=e(document.createElement("div"));i.haml(a.apply(this,arguments));return g=i.contents()}var g;return{inject:b,update:function(){var i=arguments;e.each(g,function(k,d){k===0?e(d).replaceWith(b.apply(this,
i)):e(d).remove()});s()}}},onDemand:function(a,b){var g;b=["%div",{style:"text-align: center; cursor: wait"},b||"Loading..."];return function(i){var k=Array.prototype.slice.call(arguments,1);return g=e.haml.placeholder(function(){var d=Util.stringify(k);if(p[d]!==undefined)return i(p[d]);else{a.apply(this,[function(f){p[d]=f;g.update()}].concat(k));return b}})}}}})(jQuery);
