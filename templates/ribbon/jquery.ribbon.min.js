(function(a){var d;a.fn.Ribbon=function(f){function g(b){a(".menu li a:first").addClass("active");a(".menu li ul").hide();a(".menu li a:first").parent().children("ul:first").show();a(".menu li a:first").parent().children("ul:first").addClass("submenu");a(".menu li > a").click(function(){a(".orb ul").fadeOut("fast");a(this).next().css("display");a(".menu li a").removeClass("active");a(".menu ul").removeClass("submenu");a(".menu li ul").hide();a(this).addClass("active");a(this).parent().children("ul:first").addClass("submenu");
a(this).parent().children("ul:first").show();a("body").css("padding-top","120px")});a(".orbButton").click(function(){b.backStage?(a("ul.ribbon-backstage .ribbon-backstage-firstLevel .ribbon-backstage-subMenu").height(a(window).height()*0.9),a("ul.ribbon-backstage .ribbon-backstage-firstLevel div.ribbon-backstage-rightColumnWide").height(a(window).height()*0.9).width(a(window).width()),a("ul.ribbon-backstage .ribbon-backstage-firstLevel div.ribbon-backstage-rightColumnSmall").parent().children("ul").width(a(window).width()).addClass("ribbon-backstage-leftColumnWide"),
a("ul.ribbon-backstage .ribbon-backstage-firstLevel div.ribbon-backstage-rightColumnSmall").height(a(window).height()*0.9).width("200px"),a("ul.ribbon-backstage .ribbon-backstage-firstLevel div.ribbon-backstage-rightColumnSmall").css("left",a(window).width()-200).css("line-height","17px"),a(".orb ul").animate({opacity:"toggle"},"fast"),e(a(".orb li li a:first"),!0)):a(".orb ul").animate({opacity:"toggle"},"fast")});a(".orb ul").hide();a(".orb ul ul").hide();a(".orb li ul li ul").show();a(".orb li li ul").each(function(){a(this).prepend('<div style="background-color: #EBF2F7; height: 25px; line-height: 25px; width: 292px; padding-left: 9px; border-bottom: 1px solid #CFDBEB;">'+
a(this).parent().children("a:first").text()+"</div>")});a(".orb li li a").each(function(){a(this).parent().children("ul").length>0&&a(this).addClass("arrow")});a(".orb .ribbon-backstage a").live("click",function(){a(".orb ul").fadeOut("fast")});a(".ribbon-list div").click(function(b){var c=a(this).parent().width(),d=b.pageX>a(this).offset().left&&b.pageX<a(this).offset().left+a(this).width(),b=b.pageY>a(this).offset().top&&b.pageY<a(this).offset().top+a(this).height();a(".ribbon-list div ul").fadeOut("fast");
d&&b&&(a(this).attr("style","background-image: "+a(this).css("background-image")),a(this).parent().width(c),a(this).children("ul").width(c-4),a(this).children("ul").fadeIn("fast"))});a(".ribbon-list div").parents().click(function(b){a(".ribbon-list div ul:visible").each(function(){var c=b.pageX<a(".ribbon-list div ul:visible").parent().offset().left||b.pageX>a(".ribbon-list div ul:visible").parent().offset().left+a(".ribbon-list div ul:visible").parent().width(),d=b.pageY<a(".ribbon-list div ul:visible").parent().offset().top||
b.pageY>a(".ribbon-list div ul:visible").parent().offset().top+a(".ribbon-list div ul:visible").parent().height();if(c||d)a(".ribbon-list div ul:visible").each(function(){a(this).fadeOut("fast")}),a(".ribbon-list div").css("background-image","")})});a(".orb li li a").mouseover(function(){e(this)});a(".menu li > a").dblclick(function(){a("ul .submenu").animate({height:"hide"});a("body").animate({paddingTop:a(this).parent().parent().parent().parent().height()})})}function e(b,d){if(!c.backStage&&(a(b).parent().children("ul").css("display")==
"none"||a(b).parent().children("ul").length==0)&&a(b).parent().parent().parent().parent().hasClass("orb"))a(".orb li li ul").fadeOut("fast"),a(b).parent().children("ul").length>0&&a(b).parent().children("ul").fadeIn("fast");c.backStage&&(a(b).parent().children("ul").length==0&&a("ul.ribbon-backstage .ribbon-backstage-firstLevel .ribbon-backstage-subMenu:first:hidden").length>0&&a(b).parent().parent().parent().parent().hasClass("orb")&&(a(".orb li li ul").fadeOut("fast"),a(".orb li li > div").fadeOut("fast"),
a("ul.ribbon-backstage .ribbon-backstage-firstLevel:first .ribbon-backstage-subMenu:first").fadeIn("fast"),a("ul.ribbon-backstage .ribbon-backstage-firstLevel:first div").fadeIn("fast")),a(b).parent().children("ul").css("display")=="none"&&a(b).parent().children("ul").length>0&&a(b).parent().parent().parent().parent().hasClass("orb")&&(a(".orb li li ul").fadeOut("fast"),a(".orb li li > div").fadeOut("fast"),a(b).parent().children("ul").fadeIn("fast"),a(b).parent().children("div").fadeIn("fast")),
d&&(a(".orb li li ul").hide(),a(".orb li li > div").hide(),a(b).parent().children("ul").fadeIn("fast"),a(b).parent().children("div").fadeIn("fast")))}function h(b){b.altKey&&a('div[rel="accesskeyhelper"]').each(function(){a(this).css("top",a(this).parent().offset().top).css("left",a(this).parent().offset().left-20+a(this).parent().width());a(this).show()})}var c=a.extend({theme:"windows7",backStage:!1},f||{});a(".ribbon a").each(function(){a(this).attr("accesskey")&&a(this).append('<div rel="accesskeyhelper" style="display: none; position: absolute; background-image: url(images/accessbg.png); background-repeat: none; width: 16px; padding: 0px; text-align: center; height: 17px; line-height: 17px; top: '+
a(this).offset().top+"px; left: "+(a(this).offset().left+a(this).width()-15)+'px;">'+a(this).attr("accesskey")+"</div>")});a("head").append('<link href="/stylesheets/compiled/jquery/ribbon/'+c.theme+'.css" rel="stylesheet" type="text/css" />" />');d||g(c);a(document).keydown(function(a){h(a)});a(document).keyup(function(){a('div[rel="accesskeyhelper"]').hide()});a(".ribbon").parents().click(function(b){var d=b.pageX<a(".orb ul:first").offset().left||b.pageX>a(".orb ul:first").offset().left+a(".orb ul:first").width(),
b=b.pageY<a(".orb ul:first img:first").offset().top||b.pageY>a(".orb ul:first").offset().top+a(".orb ul:first").height();(d||b)&&!c.backStage&&a(".orb ul").fadeOut("fast")});d&&(a(".orb li:first ul:first img:first").remove(),a(".orb li:first ul:first img:last").remove(),a('.ribbon-list div img[src*="/arrow_down.png"]').remove());c.backStage||(a(".orb li:first ul:first").append('<img src="/images/jquery/ribbon/'+c.theme+'/menu_bottom.png" style="margin-left: -10px; margin-bottom: -22px;" />'),a(".orb li:first ul:first").prepend('<img src="/images/jquery/ribbon/'+
c.theme+'/menu_top.png" style="margin-left: -10px; margin-top: -22px;" />'));a(".ribbon-list div").each(function(){a(this).children("ul").length>0&&a(this).append('<img src="/images/jquery/ribbon/'+c.theme+'/arrow_down.png" style="float: right; margin-top: 5px;" />')});if(navigator.appVersion.indexOf("MSIE 6.0")>-1||navigator.appVersion.indexOf("MSIE 7.0")>-1)a("ul.menu li li div").css("width","90px"),a("ul.menu").css("width","500px"),a("ul.menu").css("float","left"),a("ul.menu .submenu li div.ribbon-list").css("width",
"100px"),a("ul.menu .submenu li div.ribbon-list div").css("width","100px");a("a[href="+window.location.hash+"]").click();c.backStage&&(a("ul.ribbon .orb > li > ul").addClass("ribbon-backstage"),a("ul.ribbon-backstage").width("3000px"),a("ul.ribbon-backstage").height(a(document).height()),a("ul.ribbon-backstage > li").width("130px"),a("ul.ribbon-backstage > li > a").width("125px"),a("ul.ribbon-backstage > li").addClass("ribbon-backstage-firstLevel"),a("ul.ribbon-backstage .ribbon-backstage-firstLevel > ul").addClass("ribbon-backstage-subMenu"),
a("ul.ribbon-backstage .ribbon-backstage-firstLevel .ribbon-backstage-subMenu > div").addClass("ribbon-backstage-subMenu-header"));a(".ribbon-backstage-rightColumnWide").hide();a(".ribbon-backstage-rightColumnSmall").hide();d=!0}})(jQuery);
